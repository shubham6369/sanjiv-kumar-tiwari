# Create a new complaint record
mutation createComplaint(
  $id: String!,
  $name: String!,
  $mobile: String!,
  $block: String,
  $village: String,
  $dept: String!,
  $description: String!
) @auth(level: PUBLIC) {
  complaint_insert(data: {
    id: $id,
    name: $name,
    mobile: $mobile,
    block: $block,
    village: $village,
    dept: $dept,
    description: $description,
    status: "Pending",
    date: $expr.request.time.format()
  })
}

# Get all complaints ordered by creation time
query listComplaints @auth(level: PUBLIC) {
  complaints(orderBy: [{ createdAt: DESC }]) {
    id
    name
    mobile
    block
    village
    dept
    status
    date
  }
}

# Get a single complaint by tracking ID
query getComplaintById($id: String!) @auth(level: PUBLIC) {
  complaint(key: { id: $id }) {
    name
    dept
    status
    date
  }
}

# Update complaint status from the admin panel
mutation updateComplaintStatus($id: String!, $status: String!) @auth(level: PUBLIC) {
  complaint_update(key: { id: $id }, data: { status: $status })
}

# Delete a complaint
mutation deleteComplaintRecord($id: String!) @auth(level: PUBLIC) {
  complaint_delete(key: { id: $id })
}

# Add a new official to the officers directory
mutation createOfficer(
  $name: String!,
  $phone: String!,
  $block: String!,
  $dept: String!,
  $post: String!
) @auth(level: PUBLIC) {
  officer_insert(data: {
    name: $name,
    phone: $phone,
    block: $block,
    dept: $dept,
    post: $post
  })
}

# Get all officers
query listOfficers @auth(level: PUBLIC) {
  officers(orderBy: [{ dept: ASC }]) {
    id
    name
    phone
    block
    dept
    post
  }
}
